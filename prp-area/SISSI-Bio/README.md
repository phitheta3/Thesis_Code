# ğŸ§ª PTIR Metadata Integration & Interactive Viewer â€“ SISSI-Bio

This repository contains two Python scripts developed at the **SISSI-Bio laboratory** (Elettra Sincrotrone Trieste) to support FAIR-by-design workflows for `.ptir` (HDF5) files generated by the **MIRAGE LS photothermal spectrometer** (Photothermal Spectroscopy Corp.).

---

## ğŸ“ Contents

| Script | Description |
|--------|-------------|
| `ptirodat.py` | GUI-based tool for extracting images and metadata from `.ptir` files, creating eLabFTW experiments via API, generating HTML reports, and saving FAIR-compliant HDF5 copies. |
| `ptir_data_interactive_view.py` | Generates an **interactive HTML report** visualizing the internal HDF5 tree of `.ptir` files, including metadata attributes and dataset previews. |

---

## ğŸ›  Requirements

- Python â‰¥ 3.8
- Required packages:
  - `numpy`
  - `h5py`
  - `matplotlib`
  - `requests`
  - `Pillow`
  - `PyQt6`
  - `tkinter` (usually included in Python standard)

Install all dependencies with:

```bash
pip install numpy h5py matplotlib requests pillow PyQt6
```

---

## âš™ï¸ Usage

### 1. `ptirodat.py`

This script is the main entry point for FAIR-compliant metadata integration.

It allows you to:
- Select a `.ptir` file
- Extract image datasets and representative spectra
- Fetch and parse metadata templates from **eLabFTW** (via REST API)
- Fill experimental fields via GUI
- Generate a structured HTML report of the experiment
- Save a **FAIR-enhanced** copy of the original `.ptir` file with embedded metadata

Run with:

```bash
python ptirodat.py
```

Before launching, configure the `config.json` file as follows:

```json
{
  "BASE_URL": "https://<your-elabftw-server>/api/v2",
  "API_KEY": "your-api-key",
  "TEMPLATES": {
    "Your Template Name": 29
  }
}
```

> â„¹ï¸ The FAIR version of the `.ptir` file includes an additional HDF5 group named `/elab_metadata` with structured metadata attributes grouped according to the selected template.

---

### 2. `ptir_data_interactive_view.py`

This lightweight tool generates a fully interactive HTML file to visually explore the internal structure of a `.ptir` (HDF5) file.

Main features:
- Navigable tree view of HDF5 groups and datasets
- Type-colored metadata attributes with inline type hints
- Preview of 1D datasets and small arrays
- Optional export of image datasets (2D or RGB/RGBA) as PNG files

Run it via:

```bash
python ptir_data_interactive_view.py
```

---

## ğŸ“‚ Output

During execution, the following files are created:

- `ptirodat_generated_files/`
  - `Image_000.png`, `Image_001.png`: extracted raw images
  - `*_fair.ptir`: FAIR-compliant copy of the original file with embedded metadata
  - `experiment_report.html`: rich HTML summary including metadata tables, sample images, and spectral plots

- `*.html` files (from `ptir_data_interactive_view.py`): interactive HDF5 structure visualization

---

## ğŸ‘©â€ğŸ”¬ Author

Federica Piccirilli  
SISSI-Bio Laboratory, Elettra Sincrotrone Trieste  
ğŸ“§ federica.piccirilli@areasciencepark.it  

---

## ğŸ“œ License

This work is licensed under a [Creative Commons Attribution 4.0 International License (CC BY 4.0)](https://creativecommons.org/licenses/by/4.0).

You are free to:
- Share â€” copy and redistribute the material in any medium or format  
- Adapt â€” remix, transform, and build upon the material for any purpose, even commercially

**As long as you give appropriate credit**.

---

